version: "3.3"

services:
  potainer_agent:
    image: portainer/agent:{{ portainer_agent_version }}
    container_name: portainer
    restart: always
    environment:
      - EDGE=1
      - EDGE_ID={{ portainer_agent_id }}
      - EDGE_KEY={{ portainer_agent_key }}
      - CAP_HOST_MANAGEMENT=1
      - EDGE_INSECURE_POLL=1

    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/lib/docker/volumes:/var/lib/docker/volumes
      - {{ portainer_agent_data }}:/data
      - /:/host
